<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Documents par machine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial, sans-serif; background: #f4f6f8; padding: 20px; }
h1 { color: #2c3e50; }
h2 { color: #34495e; margin-top: 20px; }
h3 { color: #2c3e50; margin-top: 10px; }
ul { list-style: none; padding-left: 0; }
li { background: #ecf0f1; margin: 8px 0; padding: 10px; border-radius: 5px; }
a { text-decoration: none; color: #2980b9; font-weight: bold; }
a:hover { text-decoration: underline; }
</style>
</head>
<body>

<h1>üìÑ Embouteillage Ligne A</h1>
<div id="content">Chargement...</div>

<script>
const pdfFolder = "pdf/";
const content = document.getElementById("content");

// Fonction pour encoder les noms dans l'URL
function encodeMachineName(name) {
  return encodeURIComponent(name);
}

// R√©cup√©rer machine depuis l'URL
const params = new URLSearchParams(window.location.search);
let machine = params.get("machine");

fetch("data.json")
  .then(res => res.json())
  .then(data => {
    // Si aucune machine pass√©e ou non existante, afficher la liste compl√®te pour QR code
    if (!machine || !data[machine]) {
      content.innerHTML = "<h2>Toutes les machines</h2>";
      for (const m in data) {
        const h3 = document.createElement("h3");
        h3.textContent = m;
        content.appendChild(h3);

        const ul = document.createElement("ul");
        for (const folder in data[m]) {
          const folderTitle = folder || "Documents";
          const liFolder = document.createElement("li");
          liFolder.innerHTML = `<strong>${folderTitle}</strong>`;
          ul.appendChild(liFolder);

          data[m][folder].forEach(file => {
            const li = document.createElement("li");
            li.innerHTML = `üìÑ <a href="${pdfFolder}${file}" target="_blank">${file.split("/").pop()}</a>`;
            ul.appendChild(li);
          });
        }

        // Ajouter un QR code pour la machine
        const qrLink = document.createElement("p");
        const encodedName = encodeMachineName(m);
        qrLink.innerHTML = `QR Code URL : <a href="?machine=${encodedName}" target="_blank">?machine=${encodedName}</a>`;
        content.appendChild(qrLink);

        content.appendChild(ul);
      }
      return;
    }

    // Afficher uniquement les fichiers de la machine s√©lectionn√©e
    content.innerHTML = `<h2>${machine}</h2>`;

    const machineData = data[machine];
    for (const folder in machineData) {
      const folderTitle = folder || "Documents";
      const h3 = document.createElement("h3");
      h3.textContent = folderTitle;
      content.appendChild(h3);

      const ul = document.createElement("ul");
      machineData[folder].forEach(file => {
        const li = document.createElement("li");
        li.innerHTML = `üìÑ <a href="${pdfFolder}${file}" target="_blank">${file.split("/").pop()}</a>`;
        ul.appendChild(li);
      });
      content.appendChild(ul);
    }
  })
  .catch(() => {
    content.innerHTML = "<p>‚ùå Impossible de charger la liste des documents</p>";
  });
</script>

</body>
</html>





