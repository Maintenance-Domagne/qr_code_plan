<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Documents par machine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial, sans-serif; background: #dce9f5; padding: 20px; }
h1 { color: #2c3e50; }
h2 { color: #34495e; margin-top: 20px; }
h3 { color: #2c3e50; margin-top: 10px; }
ul { list-style: none; padding-left: 0; }
li { background: #ecf0f1; margin: 8px 0; padding: 10px; border-radius: 5px; }
a { text-decoration: none; color: #2980b9; font-weight: bold; }
a:hover { text-decoration: underline; }
.qr { margin: 10px 0; }
</style>
</head>
<body>

<h1>üìÑ Embouteillage Ligne A</h1>
<div id="content">Chargement...</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<script>
const content = document.getElementById("content");
const params = new URLSearchParams(window.location.search);
const machineId = params.get("machine");

fetch("./data.json")
  .then(res => {
    if (!res.ok) throw new Error("HTTP " + res.status + " ‚Äì data.json introuvable");
    return res.json();
  })
  .then(data => {
    if (!machineId) {
      content.innerHTML = "<p>‚ùå Param√®tre ?machine manquant</p>";
      return;
    }

    if (!data[machineId]) {
      content.innerHTML = "<p>‚ùå Machine inconnue : " + machineId + "</p>";
      return;
    }

    const machine = data[machineId];
    content.innerHTML = `<h2>${machine.label}</h2>`;

    // QR code pour la machine
    const qrDiv = document.createElement("div");
    qrDiv.className = "qr";
    content.appendChild(qrDiv);
    new QRCode(qrDiv, {
      text: `${window.location.href}`,
      width: 128,
      height: 128
    });

    // Liste des fichiers
    for (const folder in machine) {
      if (folder === "label") continue;
      const h3 = document.createElement("h3");
      h3.textContent = folder.replaceAll("_", " ");
      content.appendChild(h3);

      const ul = document.createElement("ul");
      machine[folder].forEach(item => {
        const li = document.createElement("li");
        li.innerHTML = `üìÑ <a href="${item.file}" target="_blank">${item.name}</a>`;
        ul.appendChild(li);
      });
      content.appendChild(ul);
    }
  })
  .catch(err => {
    console.error(err);
    content.innerHTML = "<p>‚ùå ERREUR : " + err.message + "</p>";
  });
</script>

</body>
</html>


















